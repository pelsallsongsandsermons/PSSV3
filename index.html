<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pelsall Songs & Sermons</title>

    <!-- Meta -->
    <meta name="description" content="Christian songs and sermons from Pelsall Evangelical Church">
    <meta name="theme-color" content="#1a1a1a">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">

    <!-- iOS meta tags (Legacy Match) -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <!-- Icons -->
    <link rel="icon" type="image/png" href="assets/images/favicon.png">
    <link rel="apple-touch-icon" href="assets/images/app_launcher_icon.png">

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Fonts / Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://js.puter.com/v2/"></script>
    <script type="module" src="js/app.js"></script>
</head>

<body>
    <div id="app-container">
        <!-- Persistent Header -->
        <header id="main-header">
            <button id="global-back-btn" class="header-back-btn hidden" aria-label="Back">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="logo-area">
                <div class="header-text">
                    <h1>Pelsall Songs and Sermons</h1>
                </div>
                <div class="header-actions">
                    <button id="install-btn" class="header-icon-btn hidden" aria-label="Install App"
                        onclick="window.app.installPWA()">
                        <i class="fas fa-download"></i>
                    </button>
                    <button id="settings-btn" class="header-icon-btn" aria-label="Settings"
                        onclick="location.hash='#settings'">
                        <i class="fas fa-cog"></i>
                    </button>
                    <img src="assets/images/PechLogoRound.png" alt="Logo" class="logo">
                </div>
            </div>
        </header>

        <!-- Dynamic Content Area -->
        <main id="app-content">
            <!-- Views will be injected here -->
            <div class="loading-spinner">Loading...</div>
        </main>

        <!-- Persistent Player Footer -->
        <footer id="player-footer" class="hidden">
            <div class="player-controls">
                <div class="song-info">
                    <span id="player-title">Select a song</span>
                    <span id="player-artist"></span>
                </div>
                <div class="controls">
                    <button id="btn-prev" aria-label="Previous">⏮️</button>
                    <button id="btn-play" aria-label="Play/Pause">▶️</button>
                    <button id="btn-next" aria-label="Next">⏭️</button>
                </div>
                <audio id="audio-element"></audio>
            </div>
        </footer>

        <!-- Navigation Bar (Mobile Style) -->

    </div>

    <!-- iOS Install Instructions Modal (Global) -->
    <div id="ios-install-modal" class="modal hidden" onclick="this.classList.add('hidden')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3>Install on iOS</h3>
            <p>To install this app on your iPhone or iPad:</p>
            <ol style="text-align: left; margin-bottom: 20px; padding-left: 20px; color: var(--secondary-text);">
                <li style="margin-bottom: 10px;">Tap the <strong>Share</strong> button <i
                        class="fas fa-share-square"></i> in
                    your browser toolbar.</li>
                <li>Scroll down and select <strong>"Add to Home Screen"</strong> <i class="fas fa-plus-square"></i>.
                </li>
            </ol>
            <button class="btn-primary full-width-btn"
                onclick="document.getElementById('ios-install-modal').classList.add('hidden')">Got it</button>
        </div>
    </div>

    <!-- Date Search Modal -->
    <div id="date-search-modal" class="modal hidden" onclick="this.classList.add('hidden')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3>Search Dates</h3>

            <div class="date-input-group">
                <div class="date-field">
                    <label>From:</label>
                    <div class="date-select-row" id="from-date-group">
                        <select class="day-select" id="from-day">
                            <option value="">Day</option>
                        </select>
                        <select class="month-select" id="from-month">
                            <option value="">Month</option>
                            <option value="0">Jan</option>
                            <option value="1">Feb</option>
                            <option value="2">Mar</option>
                            <option value="3">Apr</option>
                            <option value="4">May</option>
                            <option value="5">Jun</option>
                            <option value="6">Jul</option>
                            <option value="7">Aug</option>
                            <option value="8">Sep</option>
                            <option value="9">Oct</option>
                            <option value="10">Nov</option>
                            <option value="11">Dec</option>
                        </select>
                        <select class="year-select" id="from-year">
                            <option value="">Year</option>
                        </select>
                    </div>
                </div>
                <div class="date-field">
                    <label>To:</label>
                    <div class="date-select-row" id="to-date-group">
                        <select class="day-select" id="to-day">
                            <option value="">Day</option>
                        </select>
                        <select class="month-select" id="to-month">
                            <option value="">Month</option>
                            <option value="0">Jan</option>
                            <option value="1">Feb</option>
                            <option value="2">Mar</option>
                            <option value="3">Apr</option>
                            <option value="4">May</option>
                            <option value="5">Jun</option>
                            <option value="6">Jul</option>
                            <option value="7">Aug</option>
                            <option value="8">Sep</option>
                            <option value="9">Oct</option>
                            <option value="10">Nov</option>
                            <option value="11">Dec</option>
                        </select>
                        <select class="year-select" id="to-year">
                            <option value="">Year</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="shortcut-group">
                <button id="last-3-months-btn" class="shortcut-btn">Last 3 Months</button>
            </div>

            <div class="modal-footer">
                <button id="apply-date-search" class="btn-primary full-width-btn">Search</button>
                <button class="btn-secondary full-width-btn"
                    onclick="document.getElementById('date-search-modal').classList.add('hidden')">Cancel</button>
            </div>
        </div>
    </div>
</body>

</html>