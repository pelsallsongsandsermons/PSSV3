# pelsall_songs_sermons_p_w_a (PSSV3 Legacy Codebase Analysis)

## 1. Project Overview
The existing codebase is a **Flutter Web Application (PWA)** designed to play Christian songs and sermons for Pelsall Evangelical Church.
- **Origin**: The code structure (e.g., `flutter_flow` directory, `FFAppState`) strongly indicates it was generated or heavily assisted by **FlutterFlow**.
- **Platform**: Targeted as a Progressive Web App (PWA).

## 2. Technical Stack
- **Framework**: Flutter (Dart)
- **Backend / Database**: **Supabase** (PostgreSQL, Auth, Storage)
- **State Management**: `Provider` pattern encapsulating `FFAppState`.
- **Routing**: `go_router`
- **Persistence**: `shared_preferences` for local state (Dark Mode, Last Played Song) and `sqflite` (likely for offline caching).

## 3. Architecture & Key Directories
### `lib/` Structure
- **`main.dart`**: Entry point. Initializes Supabase, FlutterFlow themes, and the Router.
- **`app_state.dart`**: Global state class (`FFAppState`). Manages:
    - User Preferences: `darkMode`, `showTour`
    - Playback State: `lastPlayedSong`
    - Data Cache: `_songs` list
- **`backend/`**:
    - **`supabase/`**: Supabase client configuration and table models.
    - **`schema/structs/`**: Dart objects representing data rows (e.g., `SongStruct`).
- **`pages/app_pages/`**: Contains the individual screen widgets.
- **`flutter_flow/`**: Utility classes generated by FlutterFlow (Theme, Utils).

## 4. Data Schema (Supabase)
The app relies on the following Supabase tables:
1.  **`songs_list`**: The core catalog of songs.
    - Fields: `title`, `artistname`, `urlsong` (audio source), `artUri` (album art).
2.  **`sermon_list`**: Catalog of sermons.
3.  **`book_series`**: Metadata for organizing sermons by Bible book.
4.  **`topic_series`**: Metadata for organizing sermons by topic.
5.  **`speaker_names`**: List of preachers/speakers.
6.  **`settings`**: Likely app-wide configuration.

## 5. UI & Screen Inventory
The application is divided into several feature-based screens found in `lib/pages/app_pages`:
-   **`home_page`**: The main landing screen.
-   **`pss_song_player`**: Dedicated audio player interface.
-   **`pss_list_of_songs`**: Browsable list of all available songs.
-   **`pss_list_of_recent_sermons`**: Display of the newest uploaded sermons.
-   **`pssfind_sermons`**: Search functionality for sermons.
-   **`pss_list_of_series`** & **`pss_list_of_topics`**: Categorized views for sermon series.
-   **`pss_sermons_in_series`** & **`pss_topic_sermons_in_series`**: Detail views listing sermons within a specific category.

## 6. Migration to Native HTML/JS/CSS
To refactor this into a native PWA, the following steps are recommended:
1.  **Project Setup**: Initialize a standard web project (HTML5, Vanilla JS or a lightweight framework if preferred, CSS3).
2.  **Supabase Client**: Use the `supabase-js` library to replicate the backend connection seen in `lib/backend/supabase/`.
3.  **Routing**: Implement a simple client-side router (e.g., using History API) to map to the screens listed above.
4.  **Audio Player**: Use the native HTML5 `<audio>` element, styled to match `pss_song_player`.
5.  **State**: Replicate `FFAppState` using a global JS object or simple state management pattern, persisting to `localStorage`.
